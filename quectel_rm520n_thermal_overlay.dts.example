// SPDX-License-Identifier: (GPL-3.0 OR MIT)
/*
 * Device Tree Overlay Example for Quectel RM520N Thermal Management
 * 
 * This example shows how to add thermal zone support for the Quectel RM520N
 * modem to your device tree. This example does NOT include cooling maps or
 * fan control - those will be added in a separate example.
 * 
 * To use this overlay:
 * 1. Copy this file to your device tree directory
 * 2. Modify the thermal sensor device path to match your system
 * 3. Adjust temperature thresholds as needed for your modem
 * 4. Compile and apply the device tree overlay
 * 
 * Author: Christopher Sollinger
 * Date: 2025
 */

/dts-v1/;
/plugin/;

/ {
	compatible = "allwinner,sun50i-h6";

	/* Thermal sensor device for Quectel RM520N */
	fragment@0 {
		target-path = "/soc";
		__overlay__ {
			quectel_temp_sensor: quectel-temp-sensor {
				compatible = "quectel-rm520n-temp";
				#thermal-sensor-cells = <0>;
				status = "okay";
			};
		};
	};

	/* Thermal zone for modem temperature monitoring */
	fragment@1 {
		target-path = "/thermal-zones";
		__overlay__ {
			modem_thermal: modem-thermal {
				polling-delay-passive = <5000>;
				polling-delay = <10000>;
				thermal-sensors = <&quectel_temp_sensor>;

				trips {
					modem_trip_crit: crit {
						temperature = <85000>;
						hysteresis = <5000>;
						type = "critical";
					};

					modem_trip_hot: hot {
						temperature = <80000>;
						hysteresis = <5000>;
						type = "hot";
					};

					modem_trip_active_high: active-high {
						temperature = <75000>;
						hysteresis = <5000>;
						type = "active";
					};

					modem_trip_active_med: active-med {
						temperature = <70000>;
						hysteresis = <5000>;
						type = "active";
					};

					modem_trip_active_low: active-low {
						temperature = <65000>;
						hysteresis = <5000>;
						type = "active";
					};
				};

				/* 
				 * NOTE: No cooling maps defined in this example
				 * 
				 * To add fan control, you would add a cooling-maps section here
				 * that references your modem's cooling device (fan, etc.).
				 * 
				 * Example cooling maps will be provided in a separate example
				 * file that shows how to integrate with your specific fan hardware.
				 */
			};
		};
	};
};
